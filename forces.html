<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>External forces &mdash; oxDNA  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Observables" href="observables.html" />
    <link rel="prev" title="Efficient GPU usage" href="scaling.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            oxDNA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Input file</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurations.html">Configuration and topology files</a></li>
<li class="toctree-l1"><a class="reference internal" href="relaxation.html">Relaxing initial configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Improving performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="scaling.html">Efficient GPU usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">External forces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#common-options">Common options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#string">String</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mutual-trap">Mutual Trap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#harmonic-trap">Harmonic trap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rotating-harmonic-trap">Rotating harmonic trap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#repulsion-plane">Repulsion plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="#attraction-plane">Attraction plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="#repulsive-sphere">Repulsive sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="#yukawa-sphere">Yukawa sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-com"><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">com</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-lj-wall"><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">LJ_wall</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-sawtooth"><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">sawtooth</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-repulsion-plane-moving"><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">repulsion_plane_moving</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-hard-wall"><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">hard_wall</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="observables.html">Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="umbrella_sampling.html">Umbrella sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="ffs.html">Forward Flux Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oat/index.html">oxDNA Analysis Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oxpy/index.html">Oxpy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">oxDNA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">External forces</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/forces.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="external-forces">
<h1>External forces<a class="headerlink" href="#external-forces" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>The code implements several types of external forces that can be imposed on the system that can be used either to simulate tension exerted on DNA or simply to accelerate the formation of secondary or tertiary structure. External forces can be tricky to treat, especially in a dynamics simulation, since they are an external source of work. Care should be taken in adjusting the time step, thermostat parameters and such.</p>
<p>To enable external forces, one needs to specify <code class="docutils literal notranslate"><span class="pre">external_forces</span> <span class="pre">=</span> <span class="pre">true</span></code> in the input file and also supply an external force file to read from with the key <code class="docutils literal notranslate"><span class="pre">external_forces_file</span> <span class="pre">=</span> <span class="pre">&lt;file&gt;</span></code>.</p>
<p>The syntax of the external forces file is quite simple. Examples of such files can be found in the hairpin formation (<code class="docutils literal notranslate"><span class="pre">examples/HAIRPIN</span></code>) and pseudoknot formation (<code class="docutils literal notranslate"><span class="pre">examples/PSEUDOKNOT</span></code>) examples. Each force is specified within a block contained in curly brackets. Empty lines and lines beginning with an hash symbol (#) are ignored. Different forces require different keys to be present. If the file has the wrong syntax, oxDNA should print out a sensible error message while parsing the file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All forces act on the centre of mass of the nucleotides. Currently, it is not possible to exert forces on specific nucleotide sites (<em>e.g.</em> base or backbone) or to exert torques.</p>
</div>
<p>Forces of different kinds can be combined in the same simulation, but there is a maximum number of 15 external forces per particle for memory reasons. This can be manually overridden recompiling the code with a different value of the macro <code class="docutils literal notranslate"><span class="pre">MAX_EXT_FORCES</span></code> in <code class="docutils literal notranslate"><span class="pre">src/defs.h</span></code>.</p>
<p>The main external forces implemented in the code, together with their associated options, are presented below. The most important ones are also accompanied by a brief description and an example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">external_forces_as_JSON</span> <span class="pre">=</span> <span class="pre">true</span></code>, the external forces file will be parsed as <a class="reference external" href="https://www.json.org/">JSON</a>. This can be useful when using tools that automatise the generation of the force file. Here is a working example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;force_1&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;trap&quot;</span><span class="p">,</span>
      <span class="s2">&quot;particle&quot;</span><span class="p">:</span><span class="s2">&quot;0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stiff&quot;</span><span class="p">:</span><span class="s2">&quot;1.00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;pos0&quot;</span><span class="p">:</span><span class="s2">&quot;46.3113780977, 11.1604626391, 26.8730311801&quot;</span><span class="p">,</span>
      <span class="s2">&quot;rate&quot;</span><span class="p">:</span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dir&quot;</span><span class="p">:</span><span class="s2">&quot;0.,0.,-1.&quot;</span>
   <span class="p">},</span>
   <span class="s2">&quot;force_2&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;trap&quot;</span><span class="p">,</span>
      <span class="s2">&quot;particle&quot;</span><span class="p">:</span><span class="s2">&quot;99&quot;</span><span class="p">,</span>
      <span class="s2">&quot;pos0&quot;</span><span class="p">:</span><span class="s2">&quot;83.1532046751, 15.950789638, 37.3071701142&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stiff&quot;</span><span class="p">:</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;rate&quot;</span><span class="p">:</span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dir&quot;</span><span class="p">:</span><span class="s2">&quot;0.,0.,1.&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that <strong>all fields</strong> should be escaped with double quotes.</p>
</div>
<section id="common-options">
<h2>Common options<a class="headerlink" href="#common-options" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>The following two options are supported by all forces and can be used by observables or by the <a class="reference internal" href="oxpy/index.html"><span class="std std-doc">oxpy</span></a> library to retrieve information from or set options of specific external forces:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[group_name</span> <span class="pre">=</span> <span class="pre">&lt;string&gt;]</span></code>: an identifier that can be used to group forces together. Used, for instance, by the <code class="docutils literal notranslate"><span class="pre">force_energy</span></code> observable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[id</span> <span class="pre">=</span> <span class="pre">&lt;string&gt;]</span></code>: a unique identifier that can be used to refer to this specific external force.</p></li>
</ul>
</section>
<section id="string">
<h2>String<a class="headerlink" href="#string" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>A string is implemented as a force that does not depend on the particle position. Its value can be constant or can change linearly with time. It is useful as it does not fluctuate with time. A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">string</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F0</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: initial force.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: growth rate of the force, in units of [oxDNA energy units / (oxDNA distance units * (MD/MC) steps].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: direction of the force (automatically normalised by the code).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[dir_as_centre</span> <span class="pre">=</span> <span class="pre">&lt;bool&gt;]</span></code> if true the ‚Äúdir‚Äù parameter will be interpreted as the origin of the force, so that the true direction will be <code class="docutils literal notranslate"><span class="pre">dir</span> <span class="pre">-</span> <span class="pre">p-&gt;pos</span></code>.</p></li>
</ul>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The following bit of code will create an external force on the first nucleotide in the system starting at 1 simulation units (48.6 pN for DNA) and growing linearly with time at the rate of 1 simulation unit every <span class="math notranslate nohighlight">\(10^6\)</span> time steps. The force will pull the nucleotide along the z direction.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = string
particle = 0
F0 = 1.
rate = 1e-6
dir = 0., 0., 1.
}
</pre></div>
</div>
</div>
</section>
<section id="mutual-trap">
<h2>Mutual Trap<a class="headerlink" href="#mutual-trap" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This force is useful to form initial configurations. It is a harmonic force that at every moment pulls a particle towards a reference particle. It is possible to specify the separation at which the force will be 0.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note that the reference particle (<code class="docutils literal notranslate"><span class="pre">ref_particle</span></code> below) will not feel any force, thus making the name mutual trap somewhat misleading. If you want to have an actual <em>mutual</em> trap you will need to add a corresponding force on the reference particle.</p>
</div>
<p>A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">mutual_trap</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: the particle on which to exert the force.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ref_particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: particle to pull towards.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: stiffness of the trap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r0</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: equilibrium distance of the trap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PBC</span> <span class="pre">=</span> <span class="pre">&lt;bool&gt;</span></code>: (default: 1) If 0, calculate the distance between particles without considering periodic boundary conditions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: change <code class="docutils literal notranslate"><span class="pre">r0</span></code> by this much every time step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff_rate</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: change <code class="docutils literal notranslate"><span class="pre">stiff</span></code> by this much every time step.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>PBC should almost always be 1. The only common exception is if you are simulating a single long strand where you want to pull the ends together.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>Here is an example, extracted from the pseudoknot formation example (<code class="docutils literal notranslate"><span class="pre">examples/PSEUDOKNOT</span></code>). This will pull particle 14 towards particle 39, favouring an equilibrium distance of 1.4 (which corresponds roughly to the minimum of the hydrogen bonding potential, not a coincidence). The same force with opposite sign is exerted on particle 39 through a separate force. It is not necessary to have both particles feel the force, but it usually works much better.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = mutual_trap
particle = 14
ref_particle = 39
stiff = 1.
r0 = 1.2
}

{
type = mutual_trap
particle = 39
ref_particle = 14
stiff = 1.
r0 = 1.2
}
</pre></div>
</div>
</div>
</section>
<section id="harmonic-trap">
<h2>Harmonic trap<a class="headerlink" href="#harmonic-trap" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This type of force implements an harmonic trap, of arbitrary stiffness, that can move linearly with time. It can be useful to fix the position of the nucleotides to simulate attachment to something or to implement (quasi) constant extension simulations.</p>
<p>A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">trap</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pos0</span> <span class="pre">=</span> <span class="pre">&lt;float,</span> <span class="pre">float,</span> <span class="pre">float&gt;</span></code>: rest position of the trap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: stiffness of the trap (the force is stiff * dx).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: speed of the trap (length simulation units/time steps).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: direction of movement of the trap. Used only if rate is non zero.</p></li>
</ul>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>Here is an example input for a harmonic trap acting on the third nucleotide constraining it to stay close to the origin. In this example the trap does not move (rate=0), but one could have it move at a constant speed along the direction specified by dir, in this case the x direction.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = trap
particle = 2
pos0 = 0., 0., 0.
stiff = 1.0
rate = 0.
dir = 1.,0.,0.
}
</pre></div>
</div>
</div>
</section>
<section id="rotating-harmonic-trap">
<h2>Rotating harmonic trap<a class="headerlink" href="#rotating-harmonic-trap" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Same as the harmonic trap, with the exception that the trap position rotates in space with constant angular velocity. Several of these can be used e.g. to twist DNA.</p>
<p>A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">twist</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pos0</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: position of the trap when the rotation angle equals 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: stiffness of the trap (the force is stiff * dx).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: angular velocity of the trap (length simulation units/time steps).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: initial phase of the trap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: rotation axis of the trap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: masking vector of the trap: the force vector will be element-wise multiplied by the masking vector.</p></li>
</ul>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The following is an example input for a rotating trap acting on the first nucleotide forcing it to stay close to a point that starts at pos0 and then rotates around an axis containing the center point and parallel to the z axis. In this case we want to neglect the force component along the z-axis, so we set mask accordingly.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = twist
particle = 0
stiff = 1.00
rate = 1e-5
base = 0.
pos0 = 15, 0.674909093169, 18.6187733563
center = 13., 0.674909093169, 18.6187733563
axis = 0, 0, 1
mask = 1, 1, 0
}
</pre></div>
</div>
</div>
</section>
<section id="repulsion-plane">
<h2>Repulsion plane<a class="headerlink" href="#repulsion-plane" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This kind of external force implements a repulsion plane that constrains particles to stay on one side of it. It is implemented as a harmonic repulsion, but the stiffness can be made arbitrarily high to mimic a hard repulsion.</p>
<p>A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">repulsion_plane</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: stiffness of the repulsion.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: the vector normal to the plane: it should point towards the half-plane where the repulsion is not acting.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: defines the position of the plane along the direction identified by the plane normal.</p></li>
</ul>
<p>If direction is <code class="docutils literal notranslate"><span class="pre">dir</span></code><span class="math notranslate nohighlight">\( = (u,v,w)\)</span>, then the plane contains all the points <span class="math notranslate nohighlight">\((x,y,z)\)</span> that satisfy the equation: <span class="math notranslate nohighlight">\(u x + v y + w z + {\rm position} = 0\)</span>.
Only nucleotides  with coordinates <span class="math notranslate nohighlight">\((x,y,z)\)</span> that satisfy <span class="math notranslate nohighlight">\(u x + v y + w z + {\rm position} \lt 0\)</span> will feel the force.
The force exerted on a nucleotide is equal to <code class="docutils literal notranslate"><span class="pre">stiff</span></code> * <em>D</em>, where <span class="math notranslate nohighlight">\(D = | ux + vy + wz + \mbox{position}| / \sqrt{u^2 + v^2 + w^2 }\)</span> is the distance of the nucleotide from the plane.
For nucleotides for which <span class="math notranslate nohighlight">\(u x + v y + w z + {\rm position} \geq 0\)</span>, no force will be exerted.</p>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The following snippet defines a plane that acts on the whole system and will not exert any force on nucleotides with a positive x coordinate. A force proportional to 1 simulation unit * x (48.6 pN * x for DNA) will be exerted on all particles .</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = repulsion_plane
particle = -1
stiff = 1.00
dir = 1, 0, 0
position = 0
}
</pre></div>
</div>
</div>
</section>
<section id="attraction-plane">
<h2>Attraction plane<a class="headerlink" href="#attraction-plane" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This kind of external force implements an attraction plane that attracts particles towards the plane with a constant force component while constraining them to stay on one side using a repulsive force component (compare repulsion plane).
The repulsion is implemented as a harmonic interaction, but the stiffness can be made arbitrarily high to mimic a hard repulsion.
The attraction is implemented as a constant force defined as: stiffness * a, where a = 1 units of length.
Both attractive and repulsive component use the same stiffness value.</p>
<p>A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">attraction_plane</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: stiffness of the repulsion and strength of the attraction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>: the vector normal to the plane: it should point towards the half-plane where the attraction is not acting.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: defines the position of the plane along the direction identified by the plane normal.</p></li>
</ul>
<p>If direction is <code class="docutils literal notranslate"><span class="pre">dir</span></code><span class="math notranslate nohighlight">\(=(u,v,w)\)</span>, then the plane contains all the points <span class="math notranslate nohighlight">\((x,y,z)\)</span> that satisfy the equation: <span class="math notranslate nohighlight">\(u x + v y + w z + {\rm position} = 0\)</span>.
Nucleotides with coordinates <span class="math notranslate nohighlight">\((x,y,z)\)</span> that satisfy <span class="math notranslate nohighlight">\(u x + v y + w z + {\rm position} \ge 0\)</span> will feel a constant attraction force towards the plane equal to <code class="docutils literal notranslate"><span class="pre">stiff</span></code>.
Nucleotides with coordinates <span class="math notranslate nohighlight">\((x,y,z)\)</span> that satisfy <span class="math notranslate nohighlight">\(u x + v y + w z + {\rm position} \lt 0\)</span> will feel a repulsion force equal to <code class="docutils literal notranslate"><span class="pre">stiff</span></code> * <em>D</em>, where <span class="math notranslate nohighlight">\(D = | ux + vy + wz + \mbox{position}| / \sqrt{u^2 + v^2 + w^2 }\)</span> is the distance of the nucleotide from the plane.</p>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The following snippet defines an attraction plane that acts on on all nucleotides, pulling them towards the YZ plane (x-direction at origin).
Particles with a positive x-coordinate are pulled towards the YZ plane by a constant force of 1 simulation unit * x (48.6 pN * x for DNA)
A restoring force proportional to 1 simulation unit * x (48.6 pN * x for DNA) is exerted on all particles with a negative x-coordinate, constraining them at the plane.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = attraction_plane
particle = -1
stiff = 1.00
dir = 1, 0, 0
position = 0
}
</pre></div>
</div>
</div>
</section>
<section id="repulsive-sphere">
<h2>Repulsive sphere<a class="headerlink" href="#repulsive-sphere" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This force encloses particle(s) in a repulsive sphere. The repulsion force is harmonic.</p>
<p>A force of this kind is specified with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">sphere</span></code>. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stiff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: stiffness of the repulsion.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r0</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: radius of the sphere, in simulation units.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: rate of growth of the radius. Note that the growth is linear in timesteps/MC steps, not reduced time units.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[center</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;]</span></code>: centre of the sphere, defaults to <code class="docutils literal notranslate"><span class="pre">0,0,0</span></code>.</p></li>
</ul>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The following snippet defines a repulsive sphere that acts on the first 50 nucleotides, confining them within a sphere of radius 6 centred in <span class="math notranslate nohighlight">\((10, 10, 10)\)</span>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = sphere
particle = 0-50
center = 10.0,10.0,10.0
stiff = 10.0
rate = 0.
r0 = 6
}
</pre></div>
</div>
</div>
</section>
<section id="yukawa-sphere">
<h2>Yukawa sphere<a class="headerlink" href="#yukawa-sphere" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This force encloses particle(s) in a sphere that interacts through a purely repulsive <a class="reference external" href="http://www.sklogwiki.org/SklogWiki/index.php/Weeks-Chandler-Andersen_reference_system_model">WCA</a> potential complemented by a Yukawa potential of the form <span class="math notranslate nohighlight">\(A \exp(-r / \lambda)\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> is the interaction strength (which can be either positive or negative), <span class="math notranslate nohighlight">\(r\)</span> is the distance between a particle and the sphere surface, <span class="math notranslate nohighlight">\(\lambda\)</span> is the Debye length. The relevant keys are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: comma-separated list of indices of particles to apply the force to. A value of <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> applies it to all particles. Entries separated by a dash ‚Äú-‚Äù get expanded in a list of all the particles on a same strand comprised between the two indices. For instance, <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">=</span> <span class="pre">1,2,5-7</span></code> applies the force to 1,2,5,6,7 if 5 and 7 are on the same strand.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: radius of the sphere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debye_A</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: Strength the Yukawa interaction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debye_length</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: Debye length of the Yukawa interaction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WCA_epsilon</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: strength of the WCA repulsion, defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WCA_sigma</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;</span></code>: diameter of the WCA repulsion, defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WCA_n</span> <span class="pre">=</span> <span class="pre">&lt;int&gt;</span></code>: exponent of the WCA repulsion, defaults to <code class="docutils literal notranslate"><span class="pre">6</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[cutoff</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;]</span></code>: cutoff of the interaction, defaults to four times the Debye length.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[center</span> <span class="pre">=</span> <span class="pre">&lt;float&gt;,&lt;float&gt;,&lt;float&gt;]</span></code>: centre of the sphere, defaults to <code class="docutils literal notranslate"><span class="pre">0,0,0</span></code>.</p></li>
</ul>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The following snippet defines a Yukawa sphere that acts on all nucleotides, confining them within a sphere of radius 5 centred in <span class="math notranslate nohighlight">\((0, 0, 10)\)</span>. The WCA parameters are set to their defaults, while the Debye length and strength are <code class="docutils literal notranslate"><span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">-10</span></code>, respectively.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
type = yukawa_sphere
radius = 5
center = 0,0,10
debye_length = 5
debye_A = -10
particle = all
}
</pre></div>
</div>
</div>
</section>
<section id="type-com">
<h2><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">com</span></code><a class="headerlink" href="#type-com" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stiff = &lt;float&gt;
    stiffness of the spring
r0 = &lt;float&gt;
    equilibrium elongation of the spring
com_list = &lt;string&gt;
    comma-separated list containing the ids of all the particles whose
    centre of mass is subject to the force
ref_list = &lt;string&gt;
    comma-separated list containing the ids of all the particles whose
    centre of mass is the reference point for the force acting on the
    other group of particles
</pre></div>
</div>
</section>
<section id="type-lj-wall">
<h2><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">LJ_wall</span></code><a class="headerlink" href="#type-lj-wall" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dir = &lt;float&gt;,&lt;float&gt;,&lt;float&gt;
    the vector normal to the plane: it should point towards the half-plane
    where the repulsion is not acting.
position = &lt;float&gt;
    defines the position of the plane along the direction identified by
    the plane normal.
particle = &lt;int&gt;
    index of the particle on which the force shall be applied. If -1, the
    force will be exerted on all the particles.
[stiff = &lt;float&gt;]
    stiffness of the repulsion. Defaults to 1.
[sigma = &lt;float&gt;]
    &quot;Diameter&quot; of the wall. It effectively rescales the distance between
    particle and wall. Defaults to 1.
[n = &lt;int&gt;]
    Exponent of the 2n-n generalized Lennard-Jones expression. Defaults to
    6.
[only_repulsive = &lt;bool&gt;]
    If true, the interactio between particle and wall gets cut-off at the
    minimum, resulting in a purely-repulsive potential. Defaults to false.
[generate_inside = &lt;bool&gt;]
    If true the wall-particle interaction may not diverge, even for
    negative distances. Useful when generating the starting configuration.
    Defaults to false
</pre></div>
</div>
</section>
<section id="type-sawtooth">
<h2><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">sawtooth</span></code><a class="headerlink" href="#type-sawtooth" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>particle = &lt;int&gt;
    particle to apply the force to. -1 applies it to all particles.
F0 = &lt;float&gt;
    Initial force
wait_time = &lt;float&gt;
    time interval over which the force is constant. Units are (MD/MC)
    steps.
increment = &lt;float&gt;
    amount by which to increment the force every wait_time steps.
</pre></div>
</div>
</section>
<section id="type-repulsion-plane-moving">
<h2><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">repulsion_plane_moving</span></code><a class="headerlink" href="#type-repulsion-plane-moving" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stiff = &lt;float&gt;
    stiffness of the repulsion.
dir = &lt;float&gt;,&lt;float&gt;,&lt;float&gt;
    the vector normal to the plane: it should point towards the half-plane
    where the repulsion is not acting.
particle = &lt;int&gt;
    index(es) of the particle(s) on which the force shall be applied. Can
    be a list of comma-separated indexes. If -1, the force will be exerted
    on all the particles.
ref_particle = &lt;int&gt;
    index(es) of the particle(s) whose position along the normal will be
    used to define the repulsive plane(s). Can be a list of comma-
    separated indexes.
</pre></div>
</div>
</section>
<section id="type-hard-wall">
<h2><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">hard_wall</span></code><a class="headerlink" href="#type-hard-wall" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dir = &lt;float&gt;,&lt;float&gt;,&lt;float&gt;
    the vector normal to the plane: it should point towards the half-plane
    that is allowed to the particles.
position = &lt;float&gt;
    defines the position of the plane along the direction identified by
    the plane normal.
particle = &lt;int&gt;
    index of the particle on which the force shall be applied. If -1, the
    force will be exerted on all the particles.
[sigma = &lt;float&gt;]
    &quot;Diameter&quot; of the wall. It effectively rescales the distance between
    particle and wall. Defaults to 1.
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="scaling.html" class="btn btn-neutral float-left" title="Efficient GPU usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="observables.html" class="btn btn-neutral float-right" title="Observables" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Lorenzo Rovigatti, Flavio Romano, Erik Poppleton, Michael Matthies, and Petr ≈†ulc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>